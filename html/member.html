<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>팀원 소개</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <style>
    .card {
      height: 450px; /* 카드 전체 높이 증가 */
    }
    .card-img-top {
      width: 100%;
      height: 350px; /* 사진 높이 증가 */
      object-fit: cover;
    }
    .card-body {
      height: 100px; /* 카드 본문 높이 조정 */
      overflow: hidden;
    }
    #member-cards {
      margin-top: 80px; /* navbar 아래 여백 추가 */
    }
    /* 부트스트랩 버튼 스타일 재정의 */
    .btn-danger {
      background-color: #dc3545;
      border-color: #dc3545;
    }
  </style>
</head>

<body>

  <nav class="navbar">
    <div class="left">
        <img
        src="data:image/jpeg;base64,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"
        class="logo">
      <span class="team">Sparing</span>
    </div>
    <div class="right">
        <button class="btn" onClick="location.href='home.html'">Home</button>
        <button class="btn" onClick="location.href='member.html'">Member</button>
        <button class="btn" onClick="location.href='news.html'">News</button>
        <button class="btn" onClick="location.href='joinus.html'">Join us</button>

    </div>
  </nav>

  <div class="container">
    <div class="row row-cols-1 row-cols-md-3 g-4" id="member-cards">
      <!--자바스크립트로 카드 동적으로 할당-->
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

  <script>
    // Firebase 초기화 코드
    const firebaseConfig = {
        apiKey: "AIzaSyDyk5KfvhFCZyvqZLbMmSV8YmZO6F-n1r4",
        authDomain: "sparta-66308.firebaseapp.com",
        projectId: "sparta-66308",
        storageBucket: "sparta-66308.appspot.com",
        messagingSenderId: "982671223803",
       appId: "1:982671223803:web:6e7a2330df6da8cc0cf95e",
       measurementId: "G-790V0KT8F5"
    };
    firebase.initializeApp(firebaseConfig);

    const db = firebase.firestore();
    const storage = firebase.storage();

    const defaultImagePath = 'test.jpg';

    // 팀원 카드 생성 및 표시 함수
    function createMemberCard(member) {
        const col = document.createElement('div');
        col.className = 'col';
        col.innerHTML = `
            <div class="card h-100">
                <img src="${member.photoUrl}" class="card-img-top" alt="${member.name}" onerror="this.onerror=null; this.src='${getDefaultImageUrl()}'">
                <div class="card-body">
                    <h5 class="card-title">${member.name}</h5>
                    <p class="card-text">MBTI: ${member.mbti}</p>
                </div>
                <div class="card-footer">
                    <button class="btn btn-danger btn-sm" onclick="deleteMember('${member.id}')">삭제</button>
                </div>
            </div>
        `;
        document.getElementById('member-cards').appendChild(col);
    }

    // 기본 이미지 URL 가져오기
    function getDefaultImageUrl() {
        return storage.ref(defaultImagePath).getDownloadURL()
            .then(url => url)
            .catch(error => {
                console.error("기본 이미지 URL 가져오기 실패:", error);
                return ''; // 또는 로컬 경로의 기본 이미지
            });
    }

    // 팀원 데이터 가져오기 및 카드 생성
    function loadMembers() {
        db.collection("members").get().then((querySnapshot) => {
            if (querySnapshot.empty) {
                document.getElementById('member-cards').innerHTML = '<p class="text-center">등록된 팀원이 없습니다.</p>';
            } else {
                querySnapshot.forEach((doc) => {
                    const member = doc.data();
                    member.id = doc.id;
                    if (member.photoPath) {
                        storage.ref(member.photoPath).getDownloadURL().then((url) => {
                            member.photoUrl = url;
                            createMemberCard(member);
                        }).catch((error) => {
                            console.error("사진 URL 가져오기 실패:", error);
                            getDefaultImageUrl().then(defaultUrl => {
                                member.photoUrl = defaultUrl;
                                createMemberCard(member);
                            });
                        });
                    } else {
                        getDefaultImageUrl().then(defaultUrl => {
                            member.photoUrl = defaultUrl;
                            createMemberCard(member);
                        });
                    }
                });
            }
        }).catch((error) => {
            console.error("팀원 데이터 로딩 실패:", error);
            document.getElementById('member-cards').innerHTML = '<p class="text-center text-danger">데이터 로딩 중 오류가 발생했습니다.</p>';
        });
    }

    // 팀원 삭제 함수
    function deleteMember(memberId) {
        if (confirm('정말로 이 팀원을 삭제하시겠습니까?')) {
            db.collection("members").doc(memberId).delete().then(() => {
                console.log("팀원이 성공적으로 삭제되었습니다.");
                // 페이지 새로고침
                location.reload();
            }).catch((error) => {
                console.error("팀원 삭제 중 오류 발생:", error);
            });
        }
    }

    // 페이지 로드 시 팀원 데이터 불러오기
    window.onload = loadMembers;
  </script>

</body>

</html>